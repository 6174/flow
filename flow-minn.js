var i=[],j=null,k=[0,0],l,m=true;Math.n=function(a,b,c,g){return Math.sqrt((a-c)*(a-c)+(b-g)*(b-g))};objectSize=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};var n,o,q=[];
document.onkeydown=function(a){if(a.target.type!="textarea"&&a.target.type!="text")switch(a.which){case 8:a.preventDefault();s(q);break;case 32:a.preventDefault();m=!m;document.getElementById("playPause").innerHTML=m?"pause":"play";break;case 68:var b=t(q);u();for(var c in b.b)b.b[c].x+=10,b.b[c].y+=10;u();b=v(b);for(c in b)w(b[c]);j=q;break;case 67:x(q);break;case 86:c=JSON.parse(localStorage.getItem("pasteboard"));for(b in c.b)c.b[b].x+=k[0],c.b[b].y+=k[1];c=v(c);u();for(b in c)w(c[b]);break;case 88:c=
q,x(c),s(c)}};document.onmousedown=function(a){k=y(a);if(a.target.id=="container"||a.target.nodeName=="HTML"){if(!o)o=document.createElement("div"),(void 0).appendChild(o),o.className="selectBox";n=y(a);z()}};function w(a){q.push(a);a.a.c()}function u(a){if(a)q.splice(q.indexOf(a),1),a.a.c();else for(a=q.length-1;a>=0;a--)u(q[a])}document.onmouseup=function(a){k=y(a);j=null;l&&(l[2].remove(),l=null);if(n)z(),n=false,o.style.visibility="hidden"};
document.onmousemove=function(a){newMouse=y(a);if(j){var a=newMouse[0]-k[0],b=newMouse[1]-k[1],c;for(c in j)j[c].a.x+=a,j[c].a.y+=b,j[c].a.s()}l&&(l[3][0]=newMouse[0],l[3][1]=newMouse[1],l[2].c());if(n)o.style.width=Math.abs(newMouse[0]-n[0])+"px",o.style.height=Math.abs(newMouse[1]-n[1])+"px",o.style.left=Math.min(newMouse[0],n[0])+"px",o.style.top=Math.min(newMouse[1],n[1])+"px",o.style.visibility="visible",z();k=newMouse};document.onblur=function(){j=null;if(n)n=false,o.style.visibility="hidden"};
function z(){var a=Math.min(k[0],n[0]),b=Math.max(k[0],n[0]),c=Math.min(k[1],n[1]),g=Math.max(k[1],n[1]),d;for(d in i){var f=i[d],e=f.a;(e=e.x<b&&e.x+e.t>a&&e.y<g&&e.y+e.q>c)&&q.indexOf(f)==-1?w(f):!e&&q.indexOf(f)!=-1&&u(f)}}function s(a){for(var b=a.length-1;b>=0;b--)a[b].remove()}function x(a){var a=t(a),b;for(b in a.b)a.b[b].x-=k[0],a.b[b].y-=k[1];localStorage.setItem("pasteboard",JSON.stringify(a))}
function t(a){var b=[],c=[],g;for(g in a){var d=a[g];b.push(d.o());for(var f in d.a.g){var e=d.a.g[f],h;for(h in a){var p=a[h],r;for(r in p.a.d)for(var A in p.a.d[r])e==p.a.d[r][A]&&c.push({k:h,h:r,l:g,i:f,color:e.color})}}}return{b:b,j:c}}
function v(a){var b=[],c;for(c in a.b)b[c]=new B[a.b[c].type](a.b[c]);for(var g in a.j){var d=a.j[g];c=b[d.k];var f=d.h,e=b[d.l],h=d.i,d=d.color;if(c.f[f]&&e.e[h])isFinite(d)&&(d="hsl("+d+", 50%, 55%)"),e.e[h].src=c.f[f],e.e[h].r=f,d=new C(e.e[h].m,c.f[f].m,d),c.f[f].p=1,e.a.g[h]=d,c.a.d[f]||(c.a.d[f]=[]),c.a.d[f].push(d),c.a.c(),e.a.c(),d.c()}return b}
function y(a){var b=0,c=0;if(!a)a=window.event;if(a.pageX||a.pageY)b=a.pageX,c=a.pageY;else if(a.clientX||a.clientY)b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,c=a.clientY+document.body.scrollTop+document.documentElement.scrollTop;return[b,c]};var B={};function C(a,b,c){var g=document.createElement("canvas");(void 0).appendChild(g);var d;g.style["pointer-events"]="none";g.style.zIndex="-1";this.h=a;this.i=b;this.color=c;this.c=function(){var f=Math.min(a[0],b[0])-4,e=Math.min(a[1],b[1])-4,h=Math.abs(a[0]-b[0])+8,p=Math.abs(a[1]-b[1])+8;g.style.top=e;g.style.left=f;g.width=h;g.height=p;h=h/3*(a[1]>b[1]?1:2);d=g.getContext("2d");d.strokeStyle=c;d.lineCap="round";d.lineWidth=3.3;d.beginPath();d.moveTo(a[0]-f,a[1]-e);d.bezierCurveTo(h,a[1]-e,h,b[1]-
e,b[0]-f,b[1]-e);d.stroke()};this.remove=function(){(void 0).removeChild(g)}};